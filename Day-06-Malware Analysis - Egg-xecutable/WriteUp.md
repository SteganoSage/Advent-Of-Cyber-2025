## üìù Overview ‚Äì Day 6: Malware Analysis ‚Äì Egg-xecutable

Today‚Äôs challenge was about basic malware analysis on Windows using both static and dynamic analysis inside a sandboxed VM.
We played the role of Elf McBlue, investigating a suspicious executable (HopHelper.exe) that was emailed to the SOC team in the middle of the night. The goal was to understand how the malware behaves, what it changes on the system, and how it communicates over the network ‚Äì without infecting our real machine.
The room focused on:
  Principles of malware analysis<br>
  Sandboxes and why we use them<br>
  Static vs dynamic analysis<br>

Using tools like PeStudio, ProcMon, and Regshot to investigate a Windows executable

## üõ† Tools Used

Windows analysis VM (sandbox)

PeStudio ‚Äì static analysis of PE files

Regshot ‚Äì registry snapshot comparison

Process Monitor (ProcMon) ‚Äì runtime monitoring of file/registry/network activity

Built-in tools & browser for checking network indicators

## üöÄ Steps I Followed

### Environment setup & safety

Connected to the provided Windows VM as the analysis environment.

Ensured that all analysis was done inside the sandbox, not on my host OS.

Located the suspicious binary HopHelper.exe on the desktop as given in the room instructions.

### Static analysis with PeStudio

Launched PeStudio and dragged HopHelper.exe into it.

Checked:

  Hashes (including SHA256) for integrity / identification.

  Indicators flagged by PeStudio (suspicious sections, entropy, blacklisted APIs etc.).

  Imported functions, especially anything related to networking, registry modification, or persistence.

  Strings inside the binary ‚Äì this revealed:

   Hard-coded URLs / hostnames.

   Possible command-and-control (C2) references.

   A flag-like string in THM{...} format used for one of the questions.

### Preparing for dynamic analysis ‚Äì baseline snapshot

Opened Regshot and took Shot 1 of the registry (baseline).

This snapshot captures the registry state before executing the malware.

### Dynamic analysis ‚Äì running the executable

Started ProcMon and let it capture system events.

Executed HopHelper.exe and let it run for a short period.

After a few seconds:

  Paused ProcMon logging.

  Stopped interaction with the executable to avoid unnecessary noise.

### Registry comparison with Regshot

Went back to Regshot and took Shot 2 (after execution).

Clicked Compare to generate a diff report.

In the resulting text report, searched for entries related to HopHelper.

Found that the executable had added a Run key entry to the registry, showing how it achieves persistence by starting at logon.

### Network activity with ProcMon

In ProcMon, applied filters such as:

  Process Name is HopHelper.exe

  Operation contains TCP

Observed that the sample was making outbound connections using HTTP to a specific host/domain related to the sandboxed C2 infrastructure (e.g. a training ‚Äúbreachblocker‚Äù style endpoint).

This confirmed the malware communicates over the network and is not just a standalone local payload.

### Collecting answers

Used PeStudio output for:

  Hashes

  Embedded strings / flags

Used Regshot diff for:

  The full registry path modified for persistence

Used ProcMon for:

  The protocol used (HTTP) and the direction of traffic

Combined these observations to answer all the provided questions without guessing.

## ‚ùì Questions & Answers

The task questions mainly focused on:

  Reading the SHA256 hash of HopHelper.exe from PeStudio.

  Finding a hidden flag string inside the binary‚Äôs strings.

  Identifying the exact registry Run key added for persistence.

  Determining the network protocol used by the executable when communicating out.

  (Bonus) Identifying the C2/web panel hostname that the malware talks to.

All of these were solved purely by:

  Static analysis via PeStudio (hashes, strings).

  Dynamic analysis via Regshot (registry changes) and ProcMon (network activity).

I‚Äôve intentionally kept the exact values/flags out of this write-up so it remains a learning-focused reference rather than a straight answer sheet.

## üß† Learnings
Today I learnt:

The difference between static and dynamic malware analysis and when to use each.

How to safely analyse a suspicious executable inside a sandboxed environment.

How to use PeStudio to:

  Inspect hashes, imports, and suspicious indicators.

  Pull out useful IoCs from strings.

How to use Regshot to detect persistence mechanisms via registry changes.

How to use ProcMon to observe network connections and system activity made by malware.

How combining multiple tools gives a complete picture of malware behaviour instead of relying on a single indicator.
